{% extends 'base.html' %}
{% load static %}

{% block content %}
{% if movie_data %}
<br>
<h2 class="section-title text-center">HERE YOU GO!</h2>
<div class="container-fluid mt-4">
    <div class="media-grid">
        {% for movie in movie_data %}
        <div class="media-card fade-in position-relative">
            <img src="{{ movie.Poster }}" alt="{{ movie.Title }}" loading="lazy"
                onerror="this.src='https://critics.io/img/movies/poster-placeholder.png'">
            <div class="media-info">
                <div class="media-title">{{ movie.Title }}</div>
            </div>

            <!-- Hover Overlay -->
            <div class="premium-overlay d-flex flex-column justify-content-center align-items-center p-3"
                style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); opacity: 0; transition: opacity 0.3s;">
                <a href="{% url 'detail' movie.imdbID %}" class="premium-btn premium-btn-play">
                    <i class="fas fa-play me-2"></i>Play
                </a>
                {% if user.is_authenticated %}
                <a href="javascript:void(0);" onclick="openPrivacyModal('{{ movie.imdbID }}')"
                    class="premium-btn premium-btn-play" style="background: linear-gradient(45deg, #ff00cc, #333399);">
                    <i class="fas fa-users me-2"></i>Party
                </a>

                {% if movie.imdbID in watchlist_ids %}
                <form method="POST" action="{% url 'remove_from_watchlist' movie.imdbID %}" class="w-100">
                    {% csrf_token %}
                    <button type="submit" class="premium-btn premium-btn-remove">
                        <i class="fas fa-times me-2"></i>Remove
                    </button>
                </form>
                {% else %}
                <form method="POST" action="{% url 'add_to_watchlist' %}" class="w-100">
                    {% csrf_token %}
                    <input type="hidden" name="imdb_id" value="{{ movie.imdbID }}">
                    <input type="hidden" name="title" value="{{ movie.Title }}">
                    <input type="hidden" name="year" value="{{ movie.Year }}">
                    <input type="hidden" name="poster" value="{{ movie.Poster }}">
                    <button type="submit" class="premium-btn premium-btn-list">
                        <i class="fas fa-plus me-2"></i>My List
                    </button>
                </form>
                {% endif %}
                {% endif %}
            </div>
        </div>
        <style>
            .media-card:hover .premium-overlay {
                opacity: 1 !important;
            }
        </style>
        {% endfor %}
    </div>
</div>
{% else %}
<div class="container mt-5 text-center">
    <p class="text-secondary">No data available</p>
</div>
{% endif %}

{% if error %}
<div class="container mt-3 text-center">
    <p class="text-danger">Error: {{ error }}</p>
</div>
{% endif %}
{% endblock %}