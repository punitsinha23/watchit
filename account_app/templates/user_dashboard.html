{% extends 'user.html' %}

{% block content %}
<div class="container my-5 fade-in">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold mb-0" style="font-family: 'Bebas Neue', sans-serif; font-size: 2.5rem; letter-spacing: 1px;">
            Search Results
        </h2>
    </div>

    {% if error %}
    <div class="alert alert-danger text-center bg-dark border-danger text-danger">
        {{ error }}
    </div>
    {% endif %}

    {% if movie_data %}
    <div class="horizontal-scroll">
        {% for movie in movie_data %}
        <div class="movie-card-wrapper">
            <div class="card movie-card h-100 border-0 bg-transparent">
                <div class="poster-container position-relative overflow-hidden rounded-3 shadow">
                    <img src="{{ movie.Poster|default:'https://via.placeholder.com/300x450?text=No+Poster' }}"
                        class="img-fluid" style="aspect-ratio: 2/3; object-fit: cover;">

                    <div
                        class="movie-overlay position-absolute bottom-0 start-0 end-0 h-100 d-flex flex-column justify-content-end p-2">
                        <a href="{% url 'detail' movie.imdbID %}"
                            class="btn btn-light btn-sm fw-bold rounded-pill mb-2">
                            Play
                        </a>

                        <form method="POST" action="{% url 'user_dashboard' %}">
                            {% csrf_token %}
                            <input type="hidden" name="imdb_id" value="{{ movie.imdbID }}">
                            <input type="hidden" name="title" value="{{ movie.Title }}">
                            <input type="hidden" name="year" value="{{ movie.Year }}">
                            <input type="hidden" name="poster" value="{{ movie.Poster }}">
                            <button type="submit" name="add_to_watchlist"
                                class="btn btn-outline-light btn-sm rounded-pill w-100">
                                + List
                            </button>
                        </form>
                    </div>
                </div>

                <div class="mt-2">
                    <h6 class="text-truncate mb-0 fw-bold">{{ movie.Title }}</h6>
                    <p class="text-secondary small mb-0">{{ movie.Year }}</p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    {% else %}
    <div class="text-center py-5">
        <p class="h4 text-secondary">No results found</p>
    </div>
    {% endif %}
</div>

<style>
    /* SIDE SCROLL */
    .horizontal-scroll {
        display: flex;
        gap: 14px;
        overflow-x: auto;
        padding-bottom: 10px;
    }

    .horizontal-scroll::-webkit-scrollbar {
        height: 6px;
    }

    .horizontal-scroll::-webkit-scrollbar-thumb {
        background: #444;
        border-radius: 10px;
    }

    .movie-card-wrapper {
        flex: 0 0 auto;
        width: 160px;
    }

    /* HOVER */
    .poster-container:hover img {
        transform: scale(1.05);
        transition: transform 0.3s ease;
    }

    .movie-overlay {
        opacity: 0;
        transition: opacity 0.3s ease;
        background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
    }

    .poster-container:hover .movie-overlay {
        opacity: 1;
    }
</style>
{% endblock %}